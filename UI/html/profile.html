<!DOCTYPE html>
<html>
    <head>
        <title>PROFILE</title>
        <link href="../css/style2.css" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Exo:600" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Istok+Web:400,700i" rel="stylesheet">

    </head>
    <body>
        <div class="container">
            <div class="flex-container">
                <div><a href="../../index.html" ><img src="../images/stack-logo.png" alt="Stack Overflow Lite Logo" class="logo"></a></div>
                <div><h1 class="hed1">Stack Overflow Lite</h1></div>
                <div><input type="text" placeholder="Search ..."></div>
                <div><a href="../../index.html"><button type="button" class="reg" >COMMUNITY</button></a></div>
                <div><a href="login.html"><button type="button" class="log">LOG OUT</button></a></div>
            </div>
            <div class="flex-container4" id="user_data">
                <div class="row1">
                    <div class="col1">

                    </div>
                    <div class="col2">
                        <div class="cl">
                            <div class="ched">First Name:</div>
                            <div><h1 id="firstname"></h1></div>
                        </div>
                        <div class="cl">
                            <div class="ched">Username:</div>
                            <div><h1 id="username"></h1></div>
                        </div>
                        <div class="cl">
                            <div class="ched">Primary Stack:</div>
                            <div><h1>Java</h1></div>
                        </div>

                    </div>
                    <div class="col3">
                            <div class="cl">
                                <div class="ched">Surname:</div>
                                <div><h1 id="surname"></h1></div>
                                </div>
                            <div class="cl">
                                <div class="ched">Email:</div>
                                <div><h1 id="email"></h1></div>
                                </div>
                            <div class="cl">
                                <div class="ched">Rating</div>
                                <div><h1>4.3 / 5</h1></div>
                            </div>
                    </div>

                    <div class="col4">
                        <div class="cl">
                            <div class="ched">Questions Asked:</div>
                            <div><h1>1</h1></div>
                        </div>
                        <div class="cl">
                            <div class="ched">Answers Given:</div>
                            <div><h1>1</h1></div>
                        </div>
                        <span class="crow3">
                            <a href="question-form.html"><button type='button'>ADD QUESTION</button></a>
                        </span>

                    </div>
                </div>
                <div class="row2" >
                    <div class="ched"><h1>Questions Asked</h1></div>
                    <div><a href="q_a_page.html"><h2>Sample Question.</h2></a></div>
                    <div id="user_questions"><button id='view_questions' class="view">View All Users Questions</button>
                    </div>
                </div>
                </div>
                <!-- <div class="bgpic"><h2>WELCOME TO STACK OVERFLOW LITE</h2></div> -->
            </div>
        
        </div>
        
    </body>
    <script>
        document.getElementById("user_data").addEventListener('onload', updateUserData)
        document.getElementById("view_questions").addEventListener('click', viewQuestions)
        
        function updateUserData() {
            let username = localStorage.getItem("username")
            let firstname = localStorage.getItem("firstname")
            let surname = localStorage.getItem("surname")
            let email = localStorage.getItem("email")
            let token = localStorage.getItem("token")
            if (token = null) {
                redirect: window.location.replace("login.html");
            } else {
                document.getElementById("username").innerHTML = username.toString();
                document.getElementById("firstname").innerHTML = firstname.toString();
                document.getElementById("surname").innerHTML = surname.toString();
                document.getElementById("email").innerHTML = email.toString();
            }

        }

        function viewQuestions() {

            let token = localStorage.getItem("token")
            console.log(token);
            if (token = null) {
                redirect: window.location.replace("login.html");
            } else {
<<<<<<< HEAD
                fetch('https://stackoverflow-lite-collo.herokuapp.com/auth/user/questions', {
=======
<<<<<<< HEAD
                fetch('https://stackoverflow-lite-collo.herokuapp.com/auth/user/questions', {
=======
                fetch('http://127.0.0.1:5000/auth/user/questions', {
>>>>>>> 820f4501a78258999d7daf44736dbeb34722aa3a
>>>>>>> c4f15d8156a666d3e993211ca2b04ef158c7fb37
                    method: 'GET',
                    mode: 'cors',
                    headers: {
                        'Accept': 'application/json, text/plain, */*',
                        'Content-type': 'application/json',
                        'x-access-token': `${localStorage.getItem("token")}`
                    }
                }) 
                .then((res) => res.json())
                .then ((data) => {
                    console.log(data);
                    let output
                    Object.values(data['records']).forEach(function(question){
                        output = `
                                <h3>Title: ${question.question_title}</h3>
                                <br>Description: ${question.description}
                                <br>Time: ${question.post_time}
                                <br>Posted By: ${question.username}
                        `;
                    });
                    
                    document.getElementById('user_questions').innerHTML = output;
                })
            }
        }

    </script>
    <footer>
            <div class="footer-container">
                    <div>
                            <a href="../../index.html"><h1>COMMUNITY</h1></a>
                        </div>
                        <div>
                            <a href="profile.html"><h1>PROFILE</h1></a>
                        </div>
                        <div>
                                <a href="../../index.html"><h1>FAQs</h1></a>
                            </div>
                        <div>
                            <a href="#"><h1>ABOUT US</h1></a>
                        </div>
                        <div>
                            <a href="#"><h1>CONTACT US</h1></a>
                        </div>
            </div>
       </footer>
</html>