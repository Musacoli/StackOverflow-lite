<!DOCTYPE html>
<html>
    <head>
        <title>NEW QUESTION</title>
        <link rel="icon" type="image/ico" href="../images/stack-logo.png" />
        <link href="../css/style2.css" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Exo:600" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Istok+Web:400,700i" rel="stylesheet">

    </head>
    <body>

            <div class="container">
                    <div class="flex-container">
                        <div><a href="../../index.html" ><img src="../images/stack-logo.png" alt="Stack Overflow Lite Logo" class="logo"></a></div>
                        <div><h1 class="hed1">Stack Overflow Lite</h1></div>
                        <div><input type="text" placeholder="Search ..."></div>
                        <div><a href="profile.html"><button type="button" class="reg" >PROFILE</button></a></div>
                        <div><a href="login.html"><button type="button" class="log">LOG OUT</button></a></div>
                    </div>
                    <div class="flex-container3">
                        <div class="suform">
                            <div><h1>Question Form</h1></div>
                            <div>
                            <form id="question_form">
                                <!-- <div>Select Stack: <select required>
                                    <option name="Java">Java</option>
                                    <option name="Python">Python</option>
                                    <option name="HTML/CSS/JS">HTML</option>
                                    <option name="RUBY">Ruby</option>
                                    <option name="C++">C++</option>
                                </select></div><br> -->
                                <div>Question Title:<br> <textarea id="question_title" rows="2" cols="30" required></textarea></div><br>
                                <div>Description:<br>  <textarea id="description" rows="15" cols="30" required></textarea></div><br>
                                <div class="sub"><input type="submit" value="Submit"></div>
                            </form>
                        </div>
                        </div>
                    </div>
            </div>
    </body>
    <script>
        document.getElementById('question_form').addEventListener('submit', addQuestion);
        
        function addQuestion(e) {
            e.preventDefault();

            let title = document.getElementById('question_title').value;
            let description = document.getElementById('description').value;
            let token = localStorage.getItem('token');

            if (token = null) {
                redirect: window.location.replace('login.html');
            } else { 
                fetch('https://stackoverflow-lite-collo.herokuapp.com/questions', {
                    method: 'POST',
                    mode: 'cors',
                    headers: {
                        'Accept': 'application/json, text/plain, */*',
                        'Content-type': 'application/json',
                        'x-access-token': `${localStorage.getItem("token")}`
                    },
                    body: JSON.stringify({ title:title, description:description})

                })
                .then((res) => res.json())
                .then((data) => {
                    console.log(data);
                    if (data['status'] == 1 ) {
                        alert(Object.values(data['message']));
                        localStorage.setItem("question", title)
                        localStorage.setItem("description", description)
                        localStorage.setItem("qid", Object.keys(data['records']));
                        redirect: window.location.replace("new_question.html");
                    }
                    else {
                        alert(Object.values(data['message']));
                    }
            });
            }
        }
    </script> 
    <footer>
        <div class="footer-container">
                <div>
                        <a href="../../index.html"><h1>COMMUNITY</h1></a>
                    </div>
                    <div>
                        <a href="profile.html"><h1>PROFILE</h1></a>
                    </div>
                    <div>
                            <a href="../../index.html"><h1>FAQs</h1></a>
                        </div>
                    <div>
                        <a href="#"><h1>ABOUT US</h1></a>
                    </div>
                    <div>
                        <a href="#"><h1>CONTACT US</h1></a>
                    </div>
        </div>
   </footer>
</html>